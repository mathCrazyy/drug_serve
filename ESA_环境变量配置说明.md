# ESA 环境变量配置说明

## 📍 配置位置

在 ESA 控制台的**构建信息**页面中，找到**环境变量**部分进行配置。

## 🔑 需要配置的环境变量

根据 `test.py` 文件，需要在 ESA 环境变量中配置：

### 前端环境变量（ESA 构建时使用）

在 ESA 控制台的"构建信息" → "环境变量"中添加：

```
变量名：VITE_API_BASE_URL
变量值：http://your-backend-url:8000
```

**注意**：
- `VITE_API_BASE_URL` 是前端构建时使用的环境变量
- 这个值应该指向你的后端服务地址（函数计算 FC 的 HTTP 触发器地址，或 ECS 的 IP 地址）
- 如果后端还没部署，可以先填写一个占位符，部署后再更新

### 后端环境变量（在函数计算 FC 中配置）

后端的环境变量需要在**函数计算（FC）**中配置，不是在 ESA 中。

需要在函数计算的函数配置中添加：

```
变量名：API_BASE_URL
变量值：从 test.py 中获取

变量名：API_KEY
变量值：从 test.py 中获取

变量名：MODEL_ID
变量值：从 test.py 中获取
```

## 📝 配置步骤

### 在 ESA 配置前端环境变量

1. **进入构建信息页面**
   - 在 ESA 控制台，找到你的应用
   - 点击"构建信息"或"修改"按钮

2. **找到环境变量部分**
   - 向下滚动到"环境变量"部分
   - 当前显示"没有数据"

3. **添加环境变量**
   - 点击"添加"或"新增"按钮
   - 添加以下环境变量：

   ```
   变量名：VITE_API_BASE_URL
   变量值：http://your-backend-url:8000
   ```
   
   **说明**：
   - 如果后端部署在函数计算，使用函数计算的 HTTP 触发器地址
   - 如果后端部署在 ECS，使用 ECS 的公网 IP 或域名
   - 格式：`http://your-backend-url:8000` 或 `https://your-backend-url`

4. **保存配置**
   - 点击"保存"按钮
   - 重新触发构建

### 在函数计算配置后端环境变量

后端的环境变量需要在**函数计算（FC）**中配置：

1. **登录函数计算控制台**
   - https://fcnext.console.aliyun.com/

2. **进入函数配置**
   - 服务 → 函数 → 函数配置 → 环境变量

3. **添加环境变量**
   - 从 `test.py` 文件中获取的值

## ⚠️ 重要提示

1. **前端和后端环境变量不同**
   - ESA 的环境变量用于**前端构建**
   - 函数计算的环境变量用于**后端运行**

2. **VITE_ 前缀**
   - 前端环境变量必须以 `VITE_` 开头
   - 这样 Vite 才能在构建时识别并替换

3. **后端地址**
   - `VITE_API_BASE_URL` 的值必须是后端服务的实际地址
   - 如果后端还没部署，先部署后端，再配置这个值

## 🔄 配置流程

```
1. 部署后端（函数计算 FC）
   ↓
2. 获取后端地址（HTTP 触发器地址）
   ↓
3. 在 ESA 配置 VITE_API_BASE_URL = 后端地址
   ↓
4. 重新构建前端
   ↓
5. 前端可以正常连接后端
```

---

**按照以上步骤配置即可！** 🚀

